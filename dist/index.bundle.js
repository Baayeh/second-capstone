"use strict";(self.webpackChunkwebpack_template=self.webpackChunkwebpack_template||[]).push([[826],{507:()=>{const t=document.querySelector(".country-list"),e="https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/",n="https://us-central1-involvement-api.cloudfunctions.net/capstoneApi",o="IgY08bvfNLdtRYcSagqI";let a=[];const s=document.querySelector("#item-modal");document.getElementsByClassName("close")[0].onclick=()=>{s.style.display="none"};const c=async t=>{const n=document.querySelector(".comment-list");t&&await(async t=>{const n=`${e}apps/IgY08bvfNLdtRYcSagqI/comments?item_id=${t}`;return(await fetch(n,{method:"GET"})).json()})(t).then((t=>{if(!(t.length>0))throw Error("No comments");{const e=t.map((t=>`<li>\n            <span>${t.creation_date}</span>\n            <span>${t.username}</span>\n            <span>${t.comment}</span>\n            </li>`));n.innerHTML=e.join(""),s.style.display="block",(()=>{const t=document.querySelector(".comment-list");document.querySelector(".commentsCounter").textContent=t.children.length})()}})).catch((t=>{n.innerHTML=t.message}))},i=(e,a=[])=>{if(e.length){const s=e.map((t=>{const e=a.find((e=>{if(e.item_id===t.name.common.split(" ")[0])return e}));return{...t,likesCount:e?e.likes:0}}));s.length&&(async e=>{t.innerHTML=e.map((t=>{const e=t.name.common.split(" ")[0];return`<li class="country-item" data-id=${t.name.common}>\n        <div class="card">\n          <div class="country-img">\n            <img src="${t.flags.svg}" alt='${t.name.common} flag'>\n          </div>\n          <div class="card-body">\n            <p class="country-name mb-0">${t.name.common}</p>\n            <div class="likes">\n              <a href="javascript:;" type="button" class='add-like' id=${e}>\n                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>\n              </a>\n              <span class="likes-counter">${t.likesCount}</span>\n            </div>\n          </div>\n          <div class="actions">\n            <button type="button" class="comment-btn" id="${t.name.common}\n    ">Comments</button>\n          </div>\n        </div>\n      </li>`})).join(""),document.querySelectorAll(".country-item").forEach((t=>{t.addEventListener("click",(t=>{if(t.target.classList.contains("comment-btn")){const n=t.target.getAttribute("id");document.querySelector("#item-modal").setAttribute("data-id",n);const o=((t,e)=>e.find((e=>e.name.common===t.trim())))(n,e),a=document.querySelector("#country-img"),s=document.querySelector("#country-title"),i=document.querySelector("#population"),m=document.querySelector("#sub-region");a.setAttribute("src",o.flags.svg),s.innerHTML=o.name.common,i.innerHTML=`Population: ${o.population}`,m.innerHTML=o.subregion,c(o.name.common)}t.target.parentElement.classList.contains("add-like")&&(async t=>(await fetch(`${n}/apps/${o}/likes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:t})})).text())(t.target.parentElement.getAttribute("id")).then((()=>{const e=Number(t.target.parentElement.nextElementSibling.textContent);t.target.parentElement.nextElementSibling.textContent=String(e+1)}))}))}))})(s)}};document.querySelector("#add-comment").addEventListener("click",(()=>{const t=document.getElementById("item-modal").getAttribute("data-id").trim(),n=document.getElementById("name").value,o=document.getElementById("insights").value;""!==n&&""!==o&&(async t=>(await fetch(`${e}apps/IgY08bvfNLdtRYcSagqI/comments`,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(t)})).text())({item_id:t,username:n,comment:o}).then((()=>{c(t),document.getElementById("name").value="",document.getElementById("insights").value=""}))})),document.addEventListener("DOMContentLoaded",(async()=>{await(async()=>(await fetch("https://restcountries.com/v3.1/all")).json())().then((t=>(a=t.slice(0,6),(async()=>await fetch(`${n}/apps/${o}/likes`))()))).then((t=>{t.json().then((t=>{i(a,t)})).catch((()=>{i(a,[])}))}))}))}},t=>{t(t.s=507)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUdaLFVBQXNCQyxXQ21LM0N1RixNQUVSeEUsTUFBTXlFLElBQ0xBLEVBQ0czRSxPQUNBRSxNQUFNQyxJQUNMaUIsRUFBb0IsRUFBV2pCLEVBQUssSUFFckNjLE9BQU0sS0FDTEcsRUFBb0IsRUFBVyxHQUFHLEdBQ2xDLEdBQ0osRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYnBhY2stdGVtcGxhdGUvLi9zcmMvbW9kdWxlcy9jb3VudHJpZXMuanMiLCJ3ZWJwYWNrOi8vd2VicGFjay10ZW1wbGF0ZS8uL3NyYy9tb2R1bGVzL0RPTUVsZW1lbnRzLmpzIiwid2VicGFjazovL3dlYnBhY2stdGVtcGxhdGUvLi9zcmMvbW9kdWxlcy9jb21tZW50cy5qcyIsIndlYnBhY2s6Ly93ZWJwYWNrLXRlbXBsYXRlLy4vc3JjL21vZHVsZXMvbGlrZXMuanMiLCJ3ZWJwYWNrOi8vd2VicGFjay10ZW1wbGF0ZS8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJwYWNrLXRlbXBsYXRlLy4vc3JjL21vZHVsZXMvY29tbWVudHNDb3VudGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvdW50cmllcyBBUElcclxuY29uc3QgQkFTRV9VUkwgPSAnaHR0cHM6Ly9yZXN0Y291bnRyaWVzLmNvbS92My4xJztcclxuXHJcbi8vIEdldCBsaXN0IG9mIGNvdW50cmllc1xyXG5jb25zdCBnZXRDb3VudHJpZXMgPSBhc3luYyAoKSA9PiB7XHJcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtCQVNFX1VSTH0vYWxsYCk7XHJcbiAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGdldENvdW50cmllcztcclxuIiwiY29uc3QgY291bnRyeUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY291bnRyeS1saXN0Jyk7XHJcblxyXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydFxyXG5leHBvcnQgeyBjb3VudHJ5TGlzdCB9O1xyXG4iLCJjb25zdCBCQVNFX1VSTCA9ICdodHRwczovL3VzLWNlbnRyYWwxLWludm9sdmVtZW50LWFwaS5jbG91ZGZ1bmN0aW9ucy5uZXQvY2Fwc3RvbmVBcGkvJztcclxuXHJcbmNvbnN0IHNob3dDb21tZW50cyA9IGFzeW5jIChpZCkgPT4ge1xyXG4gIGNvbnN0IHVybCA9IGAke0JBU0VfVVJMfWFwcHMvSWdZMDhidmZOTGR0UlljU2FncUkvY29tbWVudHM/aXRlbV9pZD0ke2lkfWA7XHJcbiAgY29uc3QgcmVxdWVzdE9wdGlvbnMgPSB7IG1ldGhvZDogJ0dFVCcgfTtcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgcmVxdWVzdE9wdGlvbnMpO1xyXG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbn07XHJcblxyXG5jb25zdCBhZGRDb21tZW50ID0gYXN5bmMgKGRhdGEpID0+IHtcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0JBU0VfVVJMfWFwcHMvSWdZMDhidmZOTGR0UlljU2FncUkvY29tbWVudHNgLCB7XHJcbiAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgfSk7XHJcbiAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcclxufTtcclxuXHJcbmV4cG9ydCB7IHNob3dDb21tZW50cywgYWRkQ29tbWVudCB9O1xyXG4iLCIvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgb3BlcmF0b3ItbGluZWJyZWFrXHJcbmNvbnN0IElOVlZPTFZFRF9VUkwgPVxyXG4gICdodHRwczovL3VzLWNlbnRyYWwxLWludm9sdmVtZW50LWFwaS5jbG91ZGZ1bmN0aW9ucy5uZXQvY2Fwc3RvbmVBcGknO1xyXG5cclxuY29uc3QgQVBQX0lEID0gJ0lnWTA4YnZmTkxkdFJZY1NhZ3FJJztcclxuXHJcbi8vIEdldCBhbGwgTGlrZXMgLS0tLS0+ICAvYXBwcy86YXBwX2lkL2xpa2VzL1xyXG5jb25zdCBnZXRMaWtlcyA9IGFzeW5jICgpID0+IHtcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0lOVlZPTFZFRF9VUkx9L2FwcHMvJHtBUFBfSUR9L2xpa2VzYCk7XHJcbiAgcmV0dXJuIHJlc3BvbnNlO1xyXG59O1xyXG5cclxuLy8gYWRkIGxpa2UgIC0tLS0tLS0+IC9hcHBzLzphcHBfaWQvbGlrZXMvXHJcbmNvbnN0IGFkZExpa2UgPSBhc3luYyAoaWQpID0+IHtcclxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0lOVlZPTFZFRF9VUkx9L2FwcHMvJHtBUFBfSUR9L2xpa2VzYCwge1xyXG4gICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgaXRlbV9pZDogaWQsXHJcbiAgICB9KSxcclxuICB9KTtcclxuICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xyXG59O1xyXG5cclxuZXhwb3J0IHtcclxuICBJTlZWT0xWRURfVVJMLCBBUFBfSUQsIGdldExpa2VzLCBhZGRMaWtlLFxyXG59O1xyXG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBpbXBsaWNpdC1hcnJvdy1saW5lYnJlYWsgKi9cclxuLyogZXNsaW50LWRpc2FibGUgY29uc2lzdGVudC1yZXR1cm4gKi9cclxuLyogZXNsaW50LWRpc2FibGUgYXJyYXktY2FsbGJhY2stcmV0dXJuICovXHJcbi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC1leHByZXNzaW9ucyAqL1xyXG4vKiBlc2xpbnQtZGlzYWJsZSBjb21tYS1kYW5nbGUgKi9cclxuLyogZXNsaW50LWRpc2FibGUgYXJyb3ctYm9keS1zdHlsZSAqL1xyXG5pbXBvcnQgZ2V0Q291bnRyaWVzIGZyb20gJy4vbW9kdWxlcy9jb3VudHJpZXMuanMnO1xyXG5pbXBvcnQgeyBjb3VudHJ5TGlzdCB9IGZyb20gJy4vbW9kdWxlcy9ET01FbGVtZW50cy5qcyc7XHJcbmltcG9ydCB7IHNob3dDb21tZW50cywgYWRkQ29tbWVudCB9IGZyb20gJy4vbW9kdWxlcy9jb21tZW50cy5qcyc7XHJcbmltcG9ydCB7IGdldExpa2VzLCBhZGRMaWtlIH0gZnJvbSAnLi9tb2R1bGVzL2xpa2VzLmpzJztcclxuaW1wb3J0IE51bWJlck9mQ29tbWVudHMgZnJvbSAnLi9tb2R1bGVzL2NvbW1lbnRzQ291bnRlci5qcyc7XHJcblxyXG5sZXQgY291bnRyaWVzID0gW107XHJcblxyXG5jb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNpdGVtLW1vZGFsJyk7XHJcblxyXG5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjbG9zZScpWzBdLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxufTtcclxuXHJcbi8vIEdldCB0aGUgc3BlY2lmaWMgY291bnRyeVxyXG5jb25zdCBmaWx0ZXJDb3VudHJpZXMgPSAoY291bnRyeU5hbWUsIGNvdW50cnlBcnIpID0+XHJcbiAgY291bnRyeUFyci5maW5kKChpdGVtKSA9PiBpdGVtLm5hbWUuY29tbW9uID09PSBjb3VudHJ5TmFtZS50cmltKCkpO1xyXG5cclxuLy8gR2V0dGluZyB0aGUgbnVtYmVyIG9mIGNvbW1lbnRzXHJcbmNvbnN0IGdldE51bU9mQ29tbWVudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgQ29tbWVudHNDb3VudGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnQtbGlzdCcpO1xyXG4gIGNvbnN0IGNvdW50ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudHNDb3VudGVyJyk7XHJcbiAgY291bnRlci50ZXh0Q29udGVudCA9IE51bWJlck9mQ29tbWVudHMoQ29tbWVudHNDb3VudGVyLmNoaWxkcmVuKTtcclxufTtcclxuXHJcbmNvbnN0IGdldENvbW1lbnRMaXN0ID0gYXN5bmMgKGlkKSA9PiB7XHJcbiAgY29uc3QgdWxDb21tZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50LWxpc3QnKTtcclxuICBpZiAoaWQpIHtcclxuICAgIGF3YWl0IHNob3dDb21tZW50cyhpZClcclxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBsaXN0ID0gZGF0YS5tYXAoKGNvbW1lbnQpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGA8bGk+XHJcbiAgICAgICAgICAgIDxzcGFuPiR7Y29tbWVudC5jcmVhdGlvbl9kYXRlfTwvc3Bhbj5cclxuICAgICAgICAgICAgPHNwYW4+JHtjb21tZW50LnVzZXJuYW1lfTwvc3Bhbj5cclxuICAgICAgICAgICAgPHNwYW4+JHtjb21tZW50LmNvbW1lbnR9PC9zcGFuPlxyXG4gICAgICAgICAgICA8L2xpPmA7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHVsQ29tbWVudHMuaW5uZXJIVE1MID0gbGlzdC5qb2luKCcnKTtcclxuICAgICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgZ2V0TnVtT2ZDb21tZW50cygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aHJvdyBFcnJvcignTm8gY29tbWVudHMnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgdWxDb21tZW50cy5pbm5lckhUTUwgPSBlcnIubWVzc2FnZTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gRGlzcGxheSB0aGUgbGlzdCBvZiBjb3VudHJpZXNcclxuY29uc3QgZGlzcGxheUNvdW50cmllcyA9IGFzeW5jIChuZXdMaXN0KSA9PiB7XHJcbiAgY291bnRyeUxpc3QuaW5uZXJIVE1MID0gbmV3TGlzdFxyXG4gICAgLm1hcCgoY291bnRyeSkgPT4ge1xyXG4gICAgICBjb25zdCBjb3VudHJ5SWQgPSBjb3VudHJ5Lm5hbWUuY29tbW9uLnNwbGl0KCcgJylbMF07XHJcbiAgICAgIHJldHVybiBgPGxpIGNsYXNzPVwiY291bnRyeS1pdGVtXCIgZGF0YS1pZD0ke2NvdW50cnkubmFtZS5jb21tb259PlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjYXJkXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY291bnRyeS1pbWdcIj5cclxuICAgICAgICAgICAgPGltZyBzcmM9XCIke2NvdW50cnkuZmxhZ3Muc3ZnfVwiIGFsdD0nJHtjb3VudHJ5Lm5hbWUuY29tbW9ufSBmbGFnJz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNhcmQtYm9keVwiPlxyXG4gICAgICAgICAgICA8cCBjbGFzcz1cImNvdW50cnktbmFtZSBtYi0wXCI+JHtjb3VudHJ5Lm5hbWUuY29tbW9ufTwvcD5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxpa2VzXCI+XHJcbiAgICAgICAgICAgICAgPGEgaHJlZj1cImphdmFzY3JpcHQ6O1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz0nYWRkLWxpa2UnIGlkPSR7Y291bnRyeUlkfT5cclxuICAgICAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJ3LTYgaC02XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS13aWR0aD1cIjJcIiBkPVwiTTQuMzE4IDYuMzE4YTQuNSA0LjUgMCAwMDAgNi4zNjRMMTIgMjAuMzY0bDcuNjgyLTcuNjgyYTQuNSA0LjUgMCAwMC02LjM2NC02LjM2NEwxMiA3LjYzNmwtMS4zMTgtMS4zMThhNC41IDQuNSAwIDAwLTYuMzY0IDB6XCI+PC9wYXRoPjwvc3ZnPlxyXG4gICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpa2VzLWNvdW50ZXJcIj4ke2NvdW50cnkubGlrZXNDb3VudH08L3NwYW4+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiYWN0aW9uc1wiPlxyXG4gICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNvbW1lbnQtYnRuXCIgaWQ9XCIke2NvdW50cnkubmFtZS5jb21tb259XHJcbiAgICBcIj5Db21tZW50czwvYnV0dG9uPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvbGk+YDtcclxuICAgIH0pXHJcbiAgICAuam9pbignJyk7XHJcblxyXG4gIGNvbnN0IGNvdW50cnlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvdW50cnktaXRlbScpO1xyXG4gIGNvdW50cnlFbGVtZW50LmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAvLyBPcGVuIE1vZGFsIGRpYWxvZ1xyXG4gICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb21tZW50LWJ0bicpKSB7XHJcbiAgICAgICAgY29uc3QgY291bnRyeU5hbWUgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2lkJyk7XHJcbiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaXRlbS1tb2RhbCcpO1xyXG4gICAgICAgIG1vZGFsLnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGNvdW50cnlOYW1lKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBmaWx0ZXJDb3VudHJpZXMoY291bnRyeU5hbWUsIG5ld0xpc3QpO1xyXG4gICAgICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjb3VudHJ5LWltZycpO1xyXG4gICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvdW50cnktdGl0bGUnKTtcclxuICAgICAgICBjb25zdCBwb3B1bGF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3BvcHVsYXRpb24nKTtcclxuICAgICAgICBjb25zdCBzdWJSZWdpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3ViLXJlZ2lvbicpO1xyXG4gICAgICAgIGltZy5zZXRBdHRyaWJ1dGUoJ3NyYycsIHJlc3VsdC5mbGFncy5zdmcpO1xyXG4gICAgICAgIHRpdGxlLmlubmVySFRNTCA9IHJlc3VsdC5uYW1lLmNvbW1vbjtcclxuICAgICAgICBwb3B1bGF0aW9uLmlubmVySFRNTCA9IGBQb3B1bGF0aW9uOiAke3Jlc3VsdC5wb3B1bGF0aW9ufWA7XHJcbiAgICAgICAgc3ViUmVnaW9uLmlubmVySFRNTCA9IHJlc3VsdC5zdWJyZWdpb247XHJcblxyXG4gICAgICAgIC8vIGRpc3BsYXlpbmcgY29tbWVudHNcclxuICAgICAgICBnZXRDb21tZW50TGlzdChyZXN1bHQubmFtZS5jb21tb24pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBBZGQgTGlrZSBDb3VudGVyXHJcbiAgICAgIGlmIChlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWRkLWxpa2UnKSkge1xyXG4gICAgICAgIGNvbnN0IGNvdW50cnlOYW1lID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2lkJyk7XHJcbiAgICAgICAgYWRkTGlrZShjb3VudHJ5TmFtZSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjdXJyZW50Q291bnQgPSBOdW1iZXIoXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudC5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBTdHJpbmcoXHJcbiAgICAgICAgICAgIGN1cnJlbnRDb3VudCArIDFcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLy8gY3JlYXRlIG9iaiBmb3IgZWFjaCBjb3VudHJ5IHRvIGluY2x1ZGUgbGlrZXNDb3VudFxyXG5jb25zdCBjcmVhdGVOZXdDb3VudHJ5T2JqID0gKGNvdW50cmllcywgbGlrZXMgPSBbXSkgPT4ge1xyXG4gIGlmIChjb3VudHJpZXMubGVuZ3RoKSB7XHJcbiAgICBjb25zdCBuZXdMaXN0ID0gY291bnRyaWVzLm1hcCgoY291bnRyeSkgPT4ge1xyXG4gICAgICBjb25zdCBsaWtlc05vID0gbGlrZXMuZmluZCgobGlrZSkgPT4ge1xyXG4gICAgICAgIGlmIChsaWtlLml0ZW1faWQgPT09IGNvdW50cnkubmFtZS5jb21tb24uc3BsaXQoJyAnKVswXSkge1xyXG4gICAgICAgICAgcmV0dXJuIGxpa2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICAuLi5jb3VudHJ5LFxyXG4gICAgICAgIGxpa2VzQ291bnQ6IGxpa2VzTm8gPyBsaWtlc05vLmxpa2VzIDogMCxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIG5ld0xpc3QubGVuZ3RoICYmIGRpc3BsYXlDb3VudHJpZXMobmV3TGlzdCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gYWRkIGNvbW1lbnRcclxuY29uc3QgY3JlYXRlQ29tbWVudCA9ICgpID0+IHtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLWNvbW1lbnQnKTtcclxuICBzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpdGVtLW1vZGFsJykuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XHJcbiAgICBjb25zdCBjb21tZW50SUQgPSBpZC50cmltKCk7XHJcbiAgICBjb25zdCB1c2VybmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWU7XHJcbiAgICBjb25zdCBjb21tZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc2lnaHRzJykudmFsdWU7XHJcbiAgICBjb25zdCBjb21tZW50T2JqID0ge1xyXG4gICAgICBpdGVtX2lkOiBjb21tZW50SUQsXHJcbiAgICAgIHVzZXJuYW1lLFxyXG4gICAgICBjb21tZW50XHJcbiAgICB9O1xyXG4gICAgaWYgKHVzZXJuYW1lICE9PSAnJyAmJiBjb21tZW50ICE9PSAnJykge1xyXG4gICAgICBhZGRDb21tZW50KGNvbW1lbnRPYmopLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGdldENvbW1lbnRMaXN0KGNvbW1lbnRJRCk7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZSA9ICcnO1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnNpZ2h0cycpLnZhbHVlID0gJyc7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59O1xyXG5cclxuY3JlYXRlQ29tbWVudCgpO1xyXG5cclxuY29uc3QgZmV0Y2hBbGxDb3VudHJpZXMgPSBhc3luYyAoKSA9PiB7XHJcbiAgYXdhaXQgZ2V0Q291bnRyaWVzKClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvdW50cmllcyA9IGRhdGEuc2xpY2UoMCwgNik7XHJcbiAgICAgIHJldHVybiBnZXRMaWtlcygpO1xyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXNwb25zZTEpID0+IHtcclxuICAgICAgcmVzcG9uc2UxXHJcbiAgICAgICAgLmpzb24oKVxyXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICBjcmVhdGVOZXdDb3VudHJ5T2JqKGNvdW50cmllcywgZGF0YSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgY3JlYXRlTmV3Q291bnRyeU9iaihjb3VudHJpZXMsIFtdKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZldGNoQWxsQ291bnRyaWVzKTtcclxuIiwiY29uc3QgTnVtYmVyT2ZDb21tZW50cyA9IChpdGVtKSA9PiB7XHJcbiAgY29uc3QgY291bnRlciA9IGl0ZW0ubGVuZ3RoO1xyXG4gIHJldHVybiBjb3VudGVyO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTnVtYmVyT2ZDb21tZW50cztcclxuIl0sIm5hbWVzIjpbImNvdW50cnlMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiSU5WVk9MVkVEX1VSTCIsIkFQUF9JRCIsIm1vZGFsIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsIm9uY2xpY2siLCJzdHlsZSIsImRpc3BsYXkiLCJnZXRDb21tZW50TGlzdCIsImFzeW5jIiwiaWQiLCJ1bENvbW1lbnRzIiwidXJsIiwiZmV0Y2giLCJtZXRob2QiLCJqc29uIiwic2hvd0NvbW1lbnRzIiwidGhlbiIsImRhdGEiLCJsZW5ndGgiLCJFcnJvciIsImxpc3QiLCJtYXAiLCJjb21tZW50IiwiY3JlYXRpb25fZGF0ZSIsInVzZXJuYW1lIiwiaW5uZXJIVE1MIiwiam9pbiIsIkNvbW1lbnRzQ291bnRlciIsInRleHRDb250ZW50IiwiY2hpbGRyZW4iLCJnZXROdW1PZkNvbW1lbnRzIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIiwiY3JlYXRlTmV3Q291bnRyeU9iaiIsImNvdW50cmllcyIsImxpa2VzIiwibmV3TGlzdCIsImNvdW50cnkiLCJsaWtlc05vIiwiZmluZCIsImxpa2UiLCJpdGVtX2lkIiwibmFtZSIsImNvbW1vbiIsInNwbGl0IiwibGlrZXNDb3VudCIsImNvdW50cnlJZCIsImZsYWdzIiwic3ZnIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImNvdW50cnlOYW1lIiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwicmVzdWx0IiwiY291bnRyeUFyciIsIml0ZW0iLCJ0cmltIiwiZmlsdGVyQ291bnRyaWVzIiwiaW1nIiwidGl0bGUiLCJwb3B1bGF0aW9uIiwic3ViUmVnaW9uIiwic3VicmVnaW9uIiwicGFyZW50RWxlbWVudCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRleHQiLCJhZGRMaWtlIiwiY3VycmVudENvdW50IiwiTnVtYmVyIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiU3RyaW5nIiwiZGlzcGxheUNvdW50cmllcyIsImNvbW1lbnRJRCIsImdldEVsZW1lbnRCeUlkIiwidmFsdWUiLCJhZGRDb21tZW50Iiwic2xpY2UiLCJnZXRMaWtlcyIsInJlc3BvbnNlMSJdLCJzb3VyY2VSb290IjoiIn0=